"use strict";angular.module("app",["ui.router","ngCookies","validation","ngAnimate"]).run(["$rootScope","validRegex","common","MyServer",function(e,o,t,n){e.validRegex=o}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,o,t){t.hashPrefix(""),e.state("index",{url:"/index",views:{"":{templateUrl:"view/common/main.html"},"@index":{templateUrl:"view/index/index.html"},"header@index":{templateUrl:"view/common/header.html"},"footer@index":{templateUrl:"view/common/footer.html"},"login@index":{templateUrl:"view/login/login.html"}}}),o.otherwise("index")}]),angular.module("app").controller("HeaderCtrl",["$scope","$http","urls","common",function(e,o,t,n){}]),function(){angular.module("app").controller("loginCtr",["$scope","$rootScope","$state","MyServer",function(e,o,t,n){var r=$(".login-po-mask"),a=$("#login-box"),i=$("#reget-box"),l=$("#forget-box");o.login=function(){$(r).show(),$(a).show(),$(i).hide(),$(l).hide()},o.reget=function(){$(r).show(),$(i).show(),$(a).hide(),$(l).hide()},o.forget=function(){$(l).show(),$(i).hide(),$(a).hide()},o.closeLogin=function(){$(r).hide(),$(a).hide(),$(i).hide(),$(l).hide()},$(document).keyup(function(e){"27"==e.which&&o.closeLogin()}),o.errorMsg="",o.errorBox=!1,e.loginPhone,e.loginPassword,o.hideerrorBox=function(){o.errorBox=!1},o.loginSubmit=function(){if(!e.loginPhone)return o.errorBox=!0,o.errorMsg="请输入手机号码！",!1;if(!o.validRegex.Regex_Mobile.test(e.loginPhone))return o.errorBox=!0,o.errorMsg="请输入正确的手机号码！",!1;if(!e.loginPassword)return o.errorBox=!0,o.errorMsg="请输入登录密码！",!1;if(!o.validRegex.Regex_EnghlishNum.test(e.loginPassword))return o.errorBox=!0,o.errorMsg="请输入6至20位英文和数字组合密码！",!1;var t={account:e.loginPhone,password:e.loginPassword};n.login(t,function(e){"SUCCESS"==e.data.code?console.log(e):console.log("error",e.data.code)},function(e){console.log("error")})}}])}(),function(){angular.module("app").factory("common",["$state","$rootScope","lan",function(e,o,t){return o.test=function(){console.log("test$rootscope")},{test:function(){console.log("testFunction")}}}])}(),function(){angular.module("app").factory("MyServer",["$state","$http","$rootScope","urls",function(e,o,t,n){return{getToken:function(e,t,r){o({method:"get",url:n.getTokenAPI+"/token/get",data:e}).then(t,r)},errorCallback:function(e){console.log("err",e)},httpReq:function(e,n,r,a,i){t.tokenKey?o({method:e,url:n,data:r,headers:{"Token-Key":t.tokenKey,"Token-Value":t.tokenValue}}).then(a,i):(this.getToken("",function(){},function(){}),this.getToken("",function(l){"SUCCESS"==l.data.code?(t.tokenKey=l.data.data.TokenKey,t.tokenValue=l.data.data.TokenValue,o({method:e,url:n,data:r,headers:{"Token-Key":t.tokenKey,"Token-Value":t.tokenValue}}).then(a,i)):(console.log("获取token失败"),console.log("errCode: "+l.data.code,"errMsg: "+l.data.msg))},i))},login:function(e,o,t){this.httpReq("POST",n.USERBASE_API+"/passport/login",e,o,t)}}}])}(),angular.module("app").constant("lan",{login:{ACCOUNT_NULL:"请输入帐户",PASSWORD_NULL:"请输入登录密码",USER_NOT_EXIST:"帐户不存在",PWD_ERR:"很遗憾，您的密码错误",SUCCESS:"登录成功"}}),angular.module("app").constant("validRegex",{Regex_Name:/^[a-zA-Z][a-zA-Z0-9_@]{0,30}$/,Regex_NickName:/^[\u4E00-\u9FA5A-Za-z0-9_\-]+$/,Regex_Mobile:/^0?(13[0-9]|15[012356789]|18[0-9]|14[57])[0-9]{8}$/,Regex_PsaaWord:/^[a-zA-Z0-9]{6,20}$/,Regex_Card:/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/,Regex_Passport:/^1[45][0-9]{7}$|G[0-9]{8}$|P\.[0-9]{7}$|S[0-9]{7,8}$|D[0-9]{7,8}$/,Regex_BizLience:/^(\d{18}$|\d{15}$)/,Regex_Email:/^[a-zA-Z0-9]+([._\\-]*[a-zA-Z0-9])*@([a-zA-Z0-9]+[-a-zA-Z0-9]*[a-zA-Z0-9]+.){1,63}[a-zA-Z0-9]+$/,Regex_RealName:/^[a-zA-Z\u4e00-\u9fa5]{0,}$/,Regex_text:/^[\u4e00-\u9fa5]{0,}$/,Regex_isExitZh:/[\u4E00-\u9FA5\uF900-\uFA2D]/,Regex_num:/^\-?\d*$/,Regex_price:/^\d+(\.\d{1,2})?$/,Regex_EnghlishNum:/^(?=.*\d)(?=.*[a-z])[a-zA-Z\d]{6,20}$/}),angular.module("app").constant("urls",{BASE_API_V2:"http://beta.open.api.v2.vrseen.net",BASE_API:"http://beta.open.api.v2.vrseen.net",USERBASE_API:"http://beta.passport.api.vrseen.net",BBSBASE_API:"http://beta.bbs.api.vrseen.net",HomeWeb:"http://www.vrseen.com",OpenWeb:"http://beta.open.vrseen.com",BBSWeb:"http://beta.bbs.vrseen.com",StoreWeb:"http://beta.appstore2.web.vrseen.net",MStoreWeb:"http://beta.m.appstore2.web.vrseen.net",getTokenAPI:"http://beta.open.api.vrseen.net"});